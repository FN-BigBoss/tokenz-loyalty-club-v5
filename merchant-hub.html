
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TokenZ - Merchant Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- July 13, 01:18 - Merchant Module -->
    <style>
        .merchant-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }
        
        .merchant-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1;
        }
        
        .merchant-hero-content {
            position: relative;
            z-index: 2;
        }
        
        .merchant-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .merchant-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .merchant-stats {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .contact-method {
            transition: all 0.2s ease;
        }
        
        .contact-method:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .business-hours {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .rating-breakdown {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 0.75rem;
            align-items: center;
        }
        
        .rating-bar {
            background: #E5E7EB;
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .rating-fill {
            background: linear-gradient(90deg, #FCD34D, #F59E0B);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .product-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .showcase-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .showcase-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .merchant-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 3;
        }
        
        .verified-badge {
            background: linear-gradient(45deg, #10B981, #059669);
            animation: pulse 2s infinite;
        }
        
        .premium-badge {
            background: linear-gradient(45deg, #8B5CF6, #7C3AED);
        }
        
        .featured-badge {
            background: linear-gradient(45deg, #F59E0B, #D97706);
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .gallery-item {
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
        }
        
        .review-card {
            transition: all 0.2s ease;
        }
        
        .review-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .merchant-nav {
            position: sticky;
            top: 64px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .nav-item {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .nav-item:hover {
            color: #3B82F6;
        }
        
        .nav-item.active {
            color: #3B82F6;
            border-bottom: 2px solid #3B82F6;
        }
        
        .merchant-map {
            height: 300px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .map-marker {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #EF4444;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translate(-50%, -50%) translateY(0); }
            40% { transform: translate(-50%, -50%) translateY(-10px); }
            60% { transform: translate(-50%, -50%) translateY(-5px); }
        }
        
        .social-links {
            display: flex;
            gap: 1rem;
        }
        
        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.2s ease;
        }
        
        .social-link:hover {
            transform: scale(1.1);
        }
        
        .facebook { background: #1877F2; }
        .instagram { background: linear-gradient(45deg, #E4405F, #FCCC63); }
        .twitter { background: #1DA1F2; }
        .whatsapp { background: #25D366; }
        
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .category-filter {
            transition: all 0.2s ease;
        }
        
        .category-filter:hover {
            transform: scale(1.05);
        }
        
        .category-filter.active {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <button onclick="goBack()" class="mr-4 p-2 text-gray-600 hover:text-gray-900 transition-colors">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <h1 class="text-xl font-semibold text-gray-900">Merchant Hub</h1>
                </div>
                
                <div class="flex items-center space-x-4">
                    <!-- Search -->
                    <div class="relative hidden md:block">
                        <input type="text" id="merchant-search" placeholder="Search merchants..." 
                               class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                    
                    <!-- View Toggle -->
                    <div class="flex bg-gray-100 rounded-lg p-1">
                        <button onclick="setViewMode('grid')" id="grid-view-btn" class="px-3 py-1 rounded-md text-sm font-medium transition-colors bg-white text-gray-900 shadow-sm">
                            <i class="fas fa-th"></i>
                        </button>
                        <button onclick="setViewMode('list')" id="list-view-btn" class="px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900">
                            <i class="fas fa-list"></i>
                        </button>
                        <button onclick="setViewMode('map')" id="map-view-btn" class="px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900">
                            <i class="fas fa-map"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Merchant Profile View (when viewing specific merchant) -->
    <div id="merchant-profile" class="hidden">
        <!-- Merchant Hero Section -->
        <div class="merchant-hero h-64 flex items-center justify-center">
            <div class="merchant-hero-content text-center text-white">
                <div class="text-6xl mb-4">☕</div>
                <h1 class="text-4xl font-bold mb-2">Bean & Brew</h1>
                <p class="text-xl opacity-90">Premium Coffee & Artisan Treats</p>
                <div class="flex items-center justify-center mt-4">
                    <div class="flex text-yellow-400 mr-2">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <span class="text-white">4.8 (1,234 reviews)</span>
                </div>
            </div>
            
            <!-- Merchant Badges -->
            <div class="merchant-badge flex flex-col space-y-2">
                <span class="verified-badge text-white text-xs px-3 py-1 rounded-full font-medium">
                    <i class="fas fa-check-circle mr-1"></i>VERIFIED
                </span>
                <span class="premium-badge text-white text-xs px-3 py-1 rounded-full font-medium">
                    <i class="fas fa-crown mr-1"></i>PREMIUM
                </span>
            </div>
        </div>
        
        <!-- Merchant Navigation -->
        <div class="merchant-nav border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8 overflow-x-auto">
                    <div class="nav-item active py-4 px-2 text-sm font-medium whitespace-nowrap" onclick="showSection('overview')">
                        Overview
                    </div>
                    <div class="nav-item py-4 px-2 text-sm font-medium whitespace-nowrap" onclick="showSection('products')">
                        Products
                    </div>
                    <div class="nav-item py-4 px-2 text-sm font-medium whitespace-nowrap" onclick="showSection('reviews')">
                        Reviews
                    </div>
                    <div class="nav-item py-4 px-2 text-sm font-medium whitespace-nowrap" onclick="showSection('gallery')">
                        Gallery
                    </div>
                    <div class="nav-item py-4 px-2 text-sm font-medium whitespace-nowrap" onclick="showSection('contact')">
                        Contact
                    </div>
                </div>
            </div>
        </div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Overview Section -->
            <div id="overview-section" class="merchant-section">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Main Info -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- About -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h2 class="text-xl font-semibold text-gray-900 mb-4">About Bean & Brew</h2>
                            <p class="text-gray-700 leading-relaxed mb-4">
                                Bean & Brew has been serving the finest coffee and artisan treats since 2008. 
                                We're passionate about sourcing the highest quality beans from sustainable farms 
                                around the world and roasting them to perfection in our local facility.
                            </p>
                            <p class="text-gray-700 leading-relaxed">
                                Our mission is to create memorable coffee experiences that bring people together. 
                                From our signature blends to seasonal specialties, every cup tells a story of 
                                craftsmanship and care.
                            </p>
                        </div>
                        
                        <!-- Key Stats -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="merchant-stats text-white rounded-lg p-4 text-center">
                                <div class="text-2xl font-bold">15+</div>
                                <div class="text-sm opacity-90">Years Experience</div>
                            </div>
                            <div class="bg-green-500 text-white rounded-lg p-4 text-center">
                                <div class="text-2xl font-bold">50K+</div>
                                <div class="text-sm opacity-90">Happy Customers</div>
                            </div>
                            <div class="bg-purple-500 text-white rounded-lg p-4 text-center">
                                <div class="text-2xl font-bold">200+</div>
                                <div class="text-sm opacity-90">Products</div>
                            </div>
                            <div class="bg-orange-500 text-white rounded-lg p-4 text-center">
                                <div class="text-2xl font-bold">4.8★</div>
                                <div class="text-sm opacity-90">Average Rating</div>
                            </div>
                        </div>
                        
                        <!-- Featured Products -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Featured Products</h3>
                            <div class="product-showcase">
                                <div class="showcase-item bg-gray-50 rounded-lg p-4" onclick="viewProduct(1)">
                                    <div class="h-32 bg-gradient-to-br from-brown-100 to-yellow-100 rounded-lg flex items-center justify-center mb-3">
                                        <span class="text-4xl">☕</span>
                                    </div>
                                    <h4 class="font-semibold text-gray-900 mb-1">Premium Coffee Subscription</h4>
                                    <p class="text-sm text-gray-600 mb-2">Monthly delivery of fresh beans</p>
                                    <div class="flex justify-between items-center">
                                        <span class="font-bold text-blue-600">R299</span>
                                        <div class="flex items-center">
                                            <span class="text-yellow-400 text-sm">★</span>
                                            <span class="text-sm text-gray-600 ml-1">4.8</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="showcase-item bg-gray-50 rounded-lg p-4" onclick="viewProduct(2)">
                                    <div class="h-32 bg-gradient-to-br from-green-100 to-blue-100 rounded-lg flex items-center justify-center mb-3">
                                        <span class="text-4xl">🥐</span>
                                    </div>
                                    <h4 class="font-semibold text-gray-900 mb-1">Fresh Pastry Box</h4>
                                    <p class="text-sm text-gray-600 mb-2">Daily baked artisan pastries</p>
                                    <div class="flex justify-between items-center">
                                        <span class="font-bold text-blue-600">R89</span>
                                        <div class="flex items-center">
                                            <span class="text-yellow-400 text-sm">★</span>
                                            <span class="text-sm text-gray-600 ml-1">4.7</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar -->
                    <div class="space-y-6">
                        <!-- Contact Methods -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Get in Touch</h3>
                            <div class="space-y-3">
                                <button onclick="contactMerchant('call')" class="contact-method w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-phone mr-2"></i>Call Now
                                </button>
                                <button onclick="contactMerchant('whatsapp')" class="contact-method w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fab fa-whatsapp mr-2"></i>WhatsApp
                                </button>
                                <button onclick="contactMerchant('email')" class="contact-method w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-envelope mr-2"></i>Email
                                </button>
                                <button onclick="contactMerchant('visit')" class="contact-method w-full border border-gray-300 text-gray-700 hover:bg-gray-50 py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-map-marker-alt mr-2"></i>Visit Store
                                </button>
                            </div>
                        </div>
                        
                        <!-- Business Hours -->
                        <div class="business-hours text-white rounded-lg p-6">
                            <h3 class="text-lg font-semibold mb-4">Business Hours</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span>Monday - Friday</span>
                                    <span>7:00 AM - 8:00 PM</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Saturday</span>
                                    <span>8:00 AM - 9:00 PM</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Sunday</span>
                                    <span>9:00 AM - 6:00 PM</span>
                                </div>
                                <div class="mt-3 pt-3 border-t border-white border-opacity-30">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 bg-green-400 rounded-full mr-2"></div>
                                        <span class="font-medium">Open Now</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Location -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Location</h3>
                            <div class="merchant-map mb-4">
                                <div class="map-marker">📍</div>
                            </div>
                            <p class="text-gray-700 text-sm mb-3">
                                123 Coffee Street<br>
                                Cape Town, Western Cape 8001<br>
                                South Africa
                            </p>
                            <button onclick="getDirections()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                                Get Directions
                            </button>
                        </div>
                        
                        <!-- Social Links -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Follow Us</h3>
                            <div class="social-links">
                                <a href="#" class="social-link facebook" onclick="openSocial('facebook')">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="#" class="social-link instagram" onclick="openSocial('instagram')">
                                    <i class="fab fa-instagram"></i>
                                </a>
                                <a href="#" class="social-link twitter" onclick="openSocial('twitter')">
                                    <i class="fab fa-twitter"></i>
                                </a>
                                <a href="#" class="social-link whatsapp" onclick="openSocial('whatsapp')">
                                    <i class="fab fa-whatsapp"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Products Section -->
            <div id="products-section" class="merchant-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-gray-900">All Products</h2>
                    <div class="flex items-center space-x-4">
                        <!-- Category Filter -->
                        <select id="category-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="filterProducts()">
                            <option value="all">All Categories</option>
                            <option value="coffee">Coffee</option>
                            <option value="pastries">Pastries</option>
                            <option value="equipment">Equipment</option>
                            <option value="subscriptions">Subscriptions</option>
                        </select>
                        
                        <!-- Sort -->
                        <select id="sort-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="sortProducts()">
                            <option value="featured">Featured</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                            <option value="rating">Highest Rated</option>
                            <option value="newest">Newest</option>
                        </select>
                    </div>
                </div>
                
                <div id="merchant-products" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Products will be loaded here -->
                </div>
            </div>
            
            <!-- Reviews Section -->
            <div id="reviews-section" class="merchant-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-gray-900">Customer Reviews</h2>
                    <button onclick="writeReview()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        Write Review
                    </button>
                </div>
                
                <!-- Review Summary -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="text-center">
                            <div class="text-4xl font-bold text-gray-900 mb-2">4.8</div>
                            <div class="flex justify-center text-yellow-400 mb-2">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <div class="text-gray-600">Based on 1,234 reviews</div>
                        </div>
                        
                        <div class="space-y-3">
                            <div class="rating-breakdown">
                                <span class="text-sm text-gray-600">5 star</span>
                                <div class="rating-bar">
                                    <div class="rating-fill" style="width: 78%"></div>
                                </div>
                                <span class="text-sm text-gray-600">963</span>
                            </div>
                            <div class="rating-breakdown">
                                <span class="text-sm text-gray-600">4 star</span>
                                <div class="rating-bar">
                                    <div class="rating-fill" style="width: 15%"></div>
                                </div>
                                <span class="text-sm text-gray-600">185</span>
                            </div>
                            <div class="rating-breakdown">
                                <span class="text-sm text-gray-600">3 star</span>
                                <div class="rating-bar">
                                    <div class="rating-fill" style="width: 5%"></div>
                                </div>
                                <span class="text-sm text-gray-600">62</span>
                            </div>
                            <div class="rating-breakdown">
                                <span class="text-sm text-gray-600">2 star</span>
                                <div class="rating-bar">
                                    <div class="rating-fill" style="width: 1%"></div>
                                </div>
                                <span class="text-sm text-gray-600">12</span>
                            </div>
                            <div class="rating-breakdown">
                                <span class="text-sm text-gray-600">1 star</span>
                                <div class="rating-bar">
                                    <div class="rating-fill" style="width: 1%"></div>
                                </div>
                                <span class="text-sm text-gray-600">12</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Individual Reviews -->
                <div id="merchant-reviews" class="space-y-6">
                    <!-- Reviews will be loaded here -->
                </div>
            </div>
            
            <!-- Gallery Section -->
            <div id="gallery-section" class="merchant-section hidden">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Photo Gallery</h2>
                
                <div class="gallery-grid">
                    <div class="gallery-item bg-gradient-to-br from-brown-100 to-yellow-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(1)">
                        ☕
                    </div>
                    <div class="gallery-item bg-gradient-to-br from-green-100 to-blue-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(2)">
                        🥐
                    </div>
                    <div class="gallery-item bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(3)">
                        🏪
                    </div>
                    <div class="gallery-item bg-gradient-to-br from-orange-100 to-red-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(4)">
                        👥
                    </div>
                    <div class="gallery-item bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(5)">
                        🎂
                    </div>
                    <div class="gallery-item bg-gradient-to-br from-yellow-100 to-orange-100 flex items-center justify-center text-4xl" onclick="viewGalleryImage(6)">
                        ☕
                    </div>
                </div>
            </div>
            
            <!-- Contact Section -->
            <div id="contact-section" class="merchant-section hidden">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Contact Information</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <!-- Contact Form -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Send a Message</h3>
                            <form onsubmit="sendMessage(event)">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                                        <input type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                        <input type="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Subject</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option>General Inquiry</option>
                                            <option>Product Question</option>
                                            <option>Order Support</option>
                                            <option>Feedback</option>
                                            <option>Partnership</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Message</label>
                                        <textarea rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="How can we help you?"></textarea>
                                    </div>
                                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg font-semibold transition-colors">
                                        Send Message
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Contact Details -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Contact Details</h3>
                            <div class="space-y-4">
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt text-gray-400 w-5 mr-3"></i>
                                    <div>
                                        <div class="font-medium text-gray-900">Address</div>
                                        <div class="text-gray-600">123 Coffee Street, Cape Town 8001</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-phone text-gray-400 w-5 mr-3"></i>
                                    <div>
                                        <div class="font-medium text-gray-900">Phone</div>
                                        <div class="text-gray-600">+27 21 123 4567</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-envelope text-gray-400 w-5 mr-3"></i>
                                    <div>
                                        <div class="font-medium text-gray-900">Email</div>
                                        <div class="text-gray-600">hello@beanandbrew.co.za</div>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-globe text-gray-400 w-5 mr-3"></i>
                                    <div>
                                        <div class="font-medium text-gray-900">Website</div>
                                        <div class="text-gray-600">www.beanandbrew.co.za</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h3>
                            <div class="space-y-3">
                                <button onclick="contactMerchant('call')" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-phone mr-2"></i>Call Now
                                </button>
                                <button onclick="contactMerchant('whatsapp')" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fab fa-whatsapp mr-2"></i>WhatsApp
                                </button>
                                <button onclick="getDirections()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-directions mr-2"></i>Get Directions
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Merchant Directory View (default view) -->
    <div id="merchant-directory">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Filters -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <!-- Category Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                        <select id="directory-category" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="filterMerchants()">
                            <option value="all">All Categories</option>
                            <option value="food">Food & Dining</option>
                            <option value="fitness">Fitness & Health</option>
                            <option value="entertainment">Entertainment</option>
                            <option value="shopping">Shopping</option>
                            <option value="services">Services</option>
                            <option value="travel">Travel</option>
                        </select>
                    </div>
                    
                    <!-- Location Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Location</label>
                        <select id="location-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="filterMerchants()">
                            <option value="all">All Locations</option>
                            <option value="cape-town">Cape Town</option>
                            <option value="johannesburg">Johannesburg</option>
                            <option value="durban">Durban</option>
                            <option value="pretoria">Pretoria</option>
                        </select>
                    </div>
                    
                    <!-- Rating Filter -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Rating</label>
                        <select id="rating-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="filterMerchants()">
                            <option value="0">Any Rating</option>
                            <option value="4">4+ Stars</option>
                            <option value="4.5">4.5+ Stars</option>
                            <option value="5">5 Stars Only</option>
                        </select>
                    </div>
                    
                    <!-- Sort -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Sort By</label>
                        <select id="merchant-sort" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="sortMerchants()">
                            <option value="featured">Featured</option>
                            <option value="rating">Highest Rated</option>
                            <option value="reviews">Most Reviews</option>
                            <option value="newest">Newest</option>
                            <option value="distance">Distance</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Results Summary -->
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-lg font-semibold text-gray-900">
                        <span id="merchant-count">24</span> Merchants Found
                    </h2>
                    <p class="text-sm text-gray-600">Discover amazing local businesses</p>
                </div>
            </div>
            
            <!-- Merchant Grid -->
            <div id="merchants-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Merchants will be loaded here -->
            </div>
            
            <!-- Load More -->
            <div class="text-center mt-8">
                <button onclick="loadMoreMerchants()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                    Load More Merchants
                </button>
            </div>
        </div>
    </div>

    <script>
        // Merchant Hub State
        let merchantState = {
            viewMode: 'grid',
            currentView: 'directory', // 'directory' or 'profile'
            currentMerchant: null,
            currentSection: 'overview',
            merchants: [],
            filteredMerchants: [],
            filters: {
                category: 'all',
                location: 'all',
                rating: 0,
                search: ''
            },
            currentSort: 'featured'
        };

        // Initialize Merchant Hub
        function initMerchantHub() {
            console.log('🏪 July 13, 01:18 - Initializing Merchant Hub Module...');
            
            // Load merchants data
            loadMerchants();
            
            // Setup search functionality
            setupMerchantSearch();
            
            // Check if viewing specific merchant (from URL params)
            const urlParams = new URLSearchParams(window.location.search);
            const merchantId = urlParams.get('merchant');
            
            if (merchantId) {
                viewMerchantProfile(merchantId);
            } else {
                showMerchantDirectory();
            }
            
            console.log('✅ Merchant Hub Module initialized');
        }

        function loadMerchants() {
            // Generate mock merchant data
            merchantState.merchants = generateMockMerchants();
            merchantState.filteredMerchants = [...merchantState.merchants];
            displayMerchants();
        }

        function generateMockMerchants() {
            const categories = ['food', 'fitness', 'entertainment', 'shopping', 'services', 'travel'];
            const locations = ['cape-town', 'johannesburg', 'durban', 'pretoria'];
            const merchants = [];
            
            const merchantNames = [
                'Bean & Brew', 'FitLife Gym', 'Cinema Plus', 'Fashion Hub', 'Tech Repair', 'Travel Pro',
                'Pizza Palace', 'Yoga Studio', 'Game Zone', 'Beauty Salon', 'Car Service', 'Hotel Luxury',
                'Coffee Corner', 'Muscle Gym', 'Book Store', 'Jewelry Shop', 'Phone Fix', 'Adventure Tours',
                'Burger Joint', 'Dance Studio', 'Art Gallery', 'Flower Shop', 'Home Repair', 'City Tours',
                'Tea House', 'CrossFit Box', 'Music Store', 'Pet Shop', 'Cleaning Co', 'Beach Resort'
            ];
            
            const descriptions = [
                'Premium quality products and exceptional service',
                'Your trusted local business partner',
                'Serving the community with excellence',
                'Where quality meets affordability',
                'Professional service you can trust'
            ];
            
            for (let i = 0; i < 24; i++) {
                const category = categories[i % categories.length];
                const location = locations[i % locations.length];
                const rating = (Math.random() * 2 + 3).toFixed(1); // 3.0 to 5.0
                const reviews = Math.floor(Math.random() * 2000) + 50;
                
                merchants.push({
                    id: i + 1,
                    name: merchantNames[i],
                    category: category,
                    location: location,
                    rating: parseFloat(rating),
                    reviews: reviews,
                    description: descriptions[i % descriptions.length],
                    image: getCategoryEmoji(category),
                    verified: Math.random() > 0.3,
                    premium: Math.random() > 0.7,
                    featured: Math.random() > 0.8,
                    distance: (Math.random() * 20 + 0.5).toFixed(1),
                    address: generateAddress(location),
                    phone: '+27 ' + Math.floor(Math.random() * 90000000 + 10000000),
                    email: merchantNames[i].toLowerCase().replace(/\s+/g, '') + '@example.com',
                    website: 'www.' + merchantNames[i].toLowerCase().replace(/\s+/g, '') + '.co.za',
                    established: Math.floor(Math.random() * 20) + 2004,
                    employees: Math.floor(Math.random() * 50) + 5,
                    products: Math.floor(Math.random() * 200) + 20
                });
            }
            
            return merchants;
        }

        function getCategoryEmoji(category) {
            const emojis = {
                food: ['☕', '🍕', '🍔', '🥗', '🍰'][Math.floor(Math.random() * 5)],
                fitness: ['💪', '🏋️', '🧘', '🏃', '⚽'][Math.floor(Math.random() * 5)],
                entertainment: ['🎬', '🎮', '🎵', '📚', '🎭'][Math.floor(Math.random() * 5)],
                shopping: ['👕', '💄', '📱', '💻', '⌚'][Math.floor(Math.random() * 5)],
                services: ['🔧', '🚗', '🏠', '🐕', '📞'][Math.floor(Math.random() * 5)],
                travel: ['✈️', '🏨', '🗺️', '🧳', '🏖️'][Math.floor(Math.random() * 5)]
            };
            
            return emojis[category] || '🏪';
        }

        function generateAddress(location) {
            const addresses = {
                'cape-town': ['123 Long Street, Cape Town', '456 Kloof Street, Cape Town', '789 Main Road, Cape Town'],
                'johannesburg': ['321 Nelson Mandela Square, Johannesburg', '654 Sandton Drive, Johannesburg', '987 Rosebank Mall, Johannesburg'],
                'durban': ['111 Florida Road, Durban', '222 Umhlanga Rocks, Durban', '333 Gateway Mall, Durban'],
                'pretoria': ['444 Church Street, Pretoria', '555 Hatfield Plaza, Pretoria', '666 Menlyn Park, Pretoria']
            };
            
            const locationAddresses = addresses[location] || ['123 Main Street'];
            return locationAddresses[Math.floor(Math.random() * locationAddresses.length)];
        }

        // View Management
        function showMerchantDirectory() {
            merchantState.currentView = 'directory';
            document.getElementById('merchant-directory').classList.remove('hidden');
            document.getElementById('merchant-profile').classList.add('hidden');
            displayMerchants();
        }

        function viewMerchantProfile(merchantId) {
            const merchant = merchantState.merchants.find(m => m.id == merchantId);
            if (!merchant) return;
            
            merchantState.currentView = 'profile';
            merchantState.currentMerchant = merchant;
            
            document.getElementById('merchant-directory').classList.add('hidden');
            document.getElementById('merchant-profile').classList.remove('hidden');
            
            loadMerchantProfile(merchant);
        }

        function loadMerchantProfile(merchant) {
            // Update merchant profile content
            showSection('overview');
            loadMerchantProducts();
            loadMerchantReviews();
        }

        // Section Navigation
        function showSection(sectionName) {
            merchantState.currentSection = sectionName;
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide sections
            document.querySelectorAll('.merchant-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionName + '-section').classList.remove('hidden');
        }

        // Display Functions
        function displayMerchants() {
            const container = document.getElementById('merchants-grid');
            const merchants = merchantState.filteredMerchants;
            
            document.getElementById('merchant-count').textContent = merchants.length;
            
            if (merchantState.viewMode === 'grid') {
                container.innerHTML = merchants.map(merchant => createMerchantCard(merchant)).join('');
            } else {
                container.innerHTML = merchants.map(merchant => createMerchantListItem(merchant)).join('');
            }
        }

        function createMerchantCard(merchant) {
            return `
                <div class="merchant-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden" onclick="viewMerchantProfile(${merchant.id})">
                    <div class="relative">
                        <div class="h-48 bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center">
                            <span class="text-6xl">${merchant.image}</span>
                        </div>
                        
                        <!-- Badges -->
                        <div class="absolute top-2 left-2 flex flex-col space-y-1">
                            ${merchant.featured ? '<span class="featured-badge text-white text-xs px-2 py-1 rounded-full font-medium">FEATURED</span>' : ''}
                            ${merchant.verified ? '<span class="verified-badge text-white text-xs px-2 py-1 rounded-full font-medium"><i class="fas fa-check-circle mr-1"></i>VERIFIED</span>' : ''}
                            ${merchant.premium ? '<span class="premium-badge text-white text-xs px-2 py-1 rounded-full font-medium"><i class="fas fa-crown mr-1"></i>PREMIUM</span>' : ''}
                        </div>
                        
                        <!-- Distance -->
                        <div class="absolute top-2 right-2 bg-white bg-opacity-90 text-gray-700 text-xs px-2 py-1 rounded-full font-medium">
                            ${merchant.distance} km
                        </div>
                    </div>
                    
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-900 mb-1">${merchant.name}</h3>
                        <p class="text-sm text-gray-600 mb-2">${merchant.description}</p>
                        
                        <!-- Rating -->
                        <div class="flex items-center mb-2">
                            <div class="flex text-yellow-400 mr-1">
                                ${'★'.repeat(Math.floor(merchant.rating))}${'☆'.repeat(5 - Math.floor(merchant.rating))}
                            </div>
                            <span class="text-sm text-gray-600">${merchant.rating} (${merchant.reviews})</span>
                        </div>
                        
                        <!-- Location -->
                        <div class="flex items-center text-sm text-gray-600 mb-3">
                            <i class="fas fa-map-marker-alt mr-1"></i>
                            <span>${merchant.address}</span>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="flex space-x-2">
                            <button onclick="contactMerchant('call', event)" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-3 rounded text-sm font-medium transition-colors">
                                <i class="fas fa-phone mr-1"></i>Call
                            </button>
                            <button onclick="contactMerchant('message', event)" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-3 rounded text-sm font-medium transition-colors">
                                <i class="fas fa-comment mr-1"></i>Message
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function createMerchantListItem(merchant) {
            return `
                <div class="merchant-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 flex items-center space-x-4" onclick="viewMerchantProfile(${merchant.id})">
                    <div class="relative flex-shrink-0">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg flex items-center justify-center">
                            <span class="text-3xl">${merchant.image}</span>
                        </div>
                        ${merchant.verified ? '<span class="verified-badge absolute -top-1 -right-1 text-white text-xs px-1 py-0.5 rounded-full font-medium">✓</span>' : ''}
                    </div>
                    
                    <div class="flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-semibold text-gray-900 mb-1">${merchant.name}</h3>
                                <p class="text-sm text-gray-600 mb-1">${merchant.description}</p>
                                <div class="flex items-center mb-2">
                                    <div class="flex text-yellow-400 mr-1 text-sm">
                                        ${'★'.repeat(Math.floor(merchant.rating))}${'☆'.repeat(5 - Math.floor(merchant.rating))}
                                    </div>
                                    <span class="text-sm text-gray-600">${merchant.rating} (${merchant.reviews})</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600">
                                    <i class="fas fa-map-marker-alt mr-1"></i>
                                    <span>${merchant.distance} km away</span>
                                </div>
                            </div>
                            
                            <div class="flex space-x-2">
                                <button onclick="contactMerchant('call', event)" class="bg-green-600 hover:bg-green-700 text-white p-2 rounded font-medium transition-colors">
                                    <i class="fas fa-phone"></i>
                                </button>
                                <button onclick="contactMerchant('message', event)" class="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded font-medium transition-colors">
                                    <i class="fas fa-comment"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Filter and Sort Functions
        function filterMerchants() {
            const category = document.getElementById('directory-category').value;
            const location = document.getElementById('location-filter').value;
            const rating = parseFloat(document.getElementById('rating-filter').value);
            
            let filtered = [...merchantState.merchants];
            
            if (category !== 'all') {
                filtered = filtered.filter(m => m.category === category);
            }
            
            if (location !== 'all') {
                filtered = filtered.filter(m => m.location === location);
            }
            
            if (rating > 0) {
                filtered = filtered.filter(m => m.rating >= rating);
            }
            
            if (merchantState.filters.search) {
                const query = merchantState.filters.search.toLowerCase();
                filtered = filtered.filter(m => 
                    m.name.toLowerCase().includes(query) ||
                    m.description.toLowerCase().includes(query)
                );
            }
            
            merchantState.filteredMerchants = filtered;
            sortMerchants();
        }

        function sortMerchants() {
            const sortBy = document.getElementById('merchant-sort').value;
            let sorted = [...merchantState.filteredMerchants];
            
            switch (sortBy) {
                case 'featured':
                    sorted.sort((a, b) => (b.featured ? 1 : 0) - (a.featured ? 1 : 0));
                    break;
                case 'rating':
                    sorted.sort((a, b) => b.rating - a.rating);
                    break;
                case 'reviews':
                    sorted.sort((a, b) => b.reviews - a.reviews);
                    break;
                case 'newest':
                    sorted.sort((a, b) => b.established - a.established);
                    break;
                case 'distance':
                    sorted.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
                    break;
            }
            
            merchantState.filteredMerchants = sorted;
            displayMerchants();
        }

        function setupMerchantSearch() {
            const searchInput = document.getElementById('merchant-search');
            
            searchInput.addEventListener('input', function() {
                merchantState.filters.search = this.value.trim();
                
                // Debounced search
                clearTimeout(searchInput.searchTimeout);
                searchInput.searchTimeout = setTimeout(() => {
                    filterMerchants();
                }, 300);
            });
        }

        // View Mode Functions
        function setViewMode(mode) {
            merchantState.viewMode = mode;
            
            // Update buttons
            document.getElementById('grid-view-btn').className = mode === 'grid' 
                ? 'px-3 py-1 rounded-md text-sm font-medium transition-colors bg-white text-gray-900 shadow-sm'
                : 'px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900';
                
            document.getElementById('list-view-btn').className = mode === 'list' 
                ? 'px-3 py-1 rounded-md text-sm font-medium transition-colors bg-white text-gray-900 shadow-sm'
                : 'px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900';
                
            document.getElementById('map-view-btn').className = mode === 'map' 
                ? 'px-3 py-1 rounded-md text-sm font-medium transition-colors bg-white text-gray-900 shadow-sm'
                : 'px-3 py-1 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900';
            
            if (mode === 'map') {
                showToast('Map view coming soon!', 'info');
                return;
            }
            
            displayMerchants();
        }

        // Merchant Profile Functions
        function loadMerchantProducts() {
            // Generate mock products for the merchant
            const container = document.getElementById('merchant-products');
            const products = generateMerchantProducts();
            
            container.innerHTML = products.map(product => `
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden cursor-pointer hover:shadow-md transition-shadow" onclick="viewProduct(${product.id})">
                    <div class="h-48 bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center">
                        <span class="text-6xl">${product.image}</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-900 mb-1">${product.name}</h3>
                        <p class="text-sm text-gray-600 mb-2">${product.description}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-bold text-blue-600">R${product.price}</span>
                            <div class="flex items-center">
                                <span class="text-yellow-400 text-sm">★</span>
                                <span class="text-sm text-gray-600 ml-1">${product.rating}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function generateMerchantProducts() {
            const products = [];
            const productNames = [
                'Premium Coffee Subscription', 'Fresh Pastry Box', 'Artisan Blend', 'Morning Special',
                'Espresso Beans', 'Cappuccino Mix', 'Breakfast Bundle', 'Afternoon Treats'
            ];
            
            for (let i = 0; i < 8; i++) {
                products.push({
                    id: i + 1,
                    name: productNames[i],
                    description: 'High quality product with excellent value',
                    price: Math.floor(Math.random() * 300) + 50,
                    rating: (Math.random() * 2 + 3).toFixed(1),
                    image: ['☕', '🥐', '🍰', '🥪', '🧁', '🍪', '🥯', '🍵'][i]
                });
            }
            
            return products;
        }

        function loadMerchantReviews() {
            const container = document.getElementById('merchant-reviews');
            const reviews = generateMerchantReviews();
            
            container.innerHTML = reviews.map(review => `
                <div class="review-card bg-white border border-gray-200 rounded-lg p-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold mr-3">
                                ${review.author.charAt(0)}
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900">${review.author}</div>
                                <div class="text-sm text-gray-600">${review.date}</div>
                            </div>
                        </div>
                        <div class="flex text-yellow-400">
                            ${'★'.repeat(review.rating)}${'☆'.repeat(5 - review.rating)}
                        </div>
                    </div>
                    
                    <p class="text-gray-700 mb-3">${review.text}</p>
                    
                    <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                        <button onclick="helpfulReview(${review.id})" class="text-sm text-gray-600 hover:text-blue-600 transition-colors">
                            <i class="fas fa-thumbs-up mr-1"></i>Helpful (${review.helpful})
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function generateMerchantReviews() {
            const reviews = [];
            const authors = ['Sarah Johnson', 'Mike Chen', 'Emma Wilson', 'David Brown', 'Lisa Garcia'];
            const reviewTexts = [
                'Excellent service and quality products. Highly recommended!',
                'Great experience, will definitely come back again.',
                'Professional staff and amazing atmosphere.',
                'Good value for money and friendly service.',
                'Outstanding quality and attention to detail.'
            ];
            
            for (let i = 0; i < 5; i++) {
                reviews.push({
                    id: i + 1,
                    author: authors[i],
                    rating: Math.floor(Math.random() * 2) + 4, // 4 or 5 stars
                    text: reviewTexts[i],
                    date: `${Math.floor(Math.random() * 30) + 1} days ago`,
                    helpful: Math.floor(Math.random() * 20) + 5
                });
            }
            
            return reviews;
        }

        // Action Functions
        function contactMerchant(method, event) {
            if (event) {
                event.stopPropagation();
            }
            
            const messages = {
                call: 'Opening dialer...',
                message: 'Opening messaging app...',
                whatsapp: 'Opening WhatsApp...',
                email: 'Opening email client...',
                visit: 'Opening map directions...'
            };
            
            showToast(messages[method], 'info');
        }

        function getDirections() {
            showToast('Opening map directions...', 'info');
        }

        function openSocial(platform) {
            showToast(`Opening ${platform}...`, 'info');
        }

        function viewProduct(productId) {
            showToast(`Loading product ${productId}...`, 'info');
        }

        function viewGalleryImage(imageId) {
            showToast('Opening image gallery...', 'info');
        }

        function writeReview() {
            showToast('Opening review form...', 'info');
        }

        function helpfulReview(reviewId) {
            showToast('Marked as helpful!', 'success');
        }

        function sendMessage(event) {
            event.preventDefault();
            showToast('Message sent successfully!', 'success');
        }

        function filterProducts() {
            showToast('Filtering products...', 'info');
        }

        function sortProducts() {
            showToast('Sorting products...', 'info');
        }

        function loadMoreMerchants() {
            showToast('Loading more merchants...', 'info');
        }

        function goBack() {
            if (merchantState.currentView === 'profile') {
                showMerchantDirectory();
            } else {
                window.history.back();
            }
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 bg-white border-l-4 ${getToastColor(type)} rounded-lg shadow-lg p-4 max-w-sm fade-in`;
            
            toast.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <i class="fas fa-${getToastIcon(type)} ${getToastTextColor(type)}"></i>
                    </div>
                    <div class="ml-3 flex-1">
                        <p class="text-sm text-gray-800">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 4000);
        }

        function getToastColor(type) {
            const colors = {
                success: 'border-green-500',
                error: 'border-red-500',
                warning: 'border-yellow-500',
                info: 'border-blue-500'
            };
            return colors[type] || colors.info;
        }

        function getToastTextColor(type) {
            const colors = {
                success: 'text-green-500',
                error: 'text-red-500',
                warning: 'text-yellow-500',
                info: 'text-blue-500'
            };
            return colors[type] || colors.info;
        }

        function getToastIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle'
            };
            return icons[type] || icons.info;
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', initMerchantHub);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95e44ec6443f73e4',t:'MTc1MjM2MjgwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
